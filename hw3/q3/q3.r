X = as.matrix(read.table('ica.dat'));
res = fastICA(X, 3);

X3D = res$S;

plot(X3D[,1], X3D[,2], col='blue', pch='x', xlab='', ylab='');
plot(X3D[,1], X3D[,3], col='blue', pch='x', xlab='', ylab='');
plot(X3D[,2], X3D[,3], col='blue', pch='x', xlab='', ylab='');


sall = 0;
for(i in 1:nrow(X))
{
	if(norm(as.matrix(X[i,]),'f') > 1)
	{
		tmp = sort(abs(X3D[i,]), decreasing = TRUE);
		score = 1 - tmp[2]/tmp[1];
		writeLines(sprintf('%d\t%f\n', i, score));
		sall = sall + score;
	}
}
writeLines(sprintf('sum(purity):\t%f\n', sall));

3	0.942024

5	0.947267

6	0.934571

8	0.965556

9	0.983800

10	0.954793

14	0.923974

15	0.968508

17	0.969319

18	0.983167

19	0.971077

20	0.965102

21	0.952221

22	0.953984

24	0.968634

25	0.873687

26	0.964082

28	0.898228

29	0.943379

31	0.943089

33	0.937174

34	0.978971

35	0.973655

36	0.943820

41	0.963117

43	0.918520

45	0.940552

48	0.933755

49	0.898981

50	0.918702

52	0.980989

53	0.983631

55	0.954673

56	0.937994

57	0.970168

58	0.990751

59	0.924208

61	0.951977

63	0.928363

64	0.968902

67	0.911796

68	0.951116

69	0.973741

70	0.867511

72	0.960568

73	0.971620

75	0.984331

77	0.972001

80	0.958560

82	0.985386

83	0.978399

84	0.963966

86	0.918965

87	0.911202

91	0.927352

94	0.929467

98	0.955828

99	0.945157

> writeLines(sprintf('sum(purity):\t%f\n', sall));
sum(purity):	55.072331
